<div class="container">
  <h1>Chat room</h1>
  <div class="row msg-container" id="<%= @conversation.uuid %>">
    <%= render partial: "message", collection: @conversation.messages %>
  </div>

  <div class="row">
    <form style="display:inherit">
      <div class="col m12 s12">
        <input type="text" id="room_speaker" data-user-uuid="<%=current_user.uuid %>" data-conversation-uuid="<%=@conversation.uuid %>" data-user-uuid="<%=current_user.uuid %>" placeholder="Say something...">
        <button type="submit" class="btn right chat-submit-button" onclick="return broadcastMsg();"><i class="material-icons">send</i></button>
      </div>
    </form>
  </div>
</div>

<script type="text/javascript">
  function broadcastMsg() {
    var elem = $("#room_speaker");

    App.conversation.speak(elem.data('user-uuid'), elem.data('conversation-uuid'), elem.val());
    elem.val('');
    return false; //prevent button submission
  }
</script>